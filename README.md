SELECT * 
FROM PRODUCT;


SELECT * 
FROM PRODUCT 
WHERE STOCK = 0 ;


SELECT * 
FROM `ORDER` 
WHERE Date = CURRENT_DATE
ORDER BY ID DESC;


SELECT Date
FROM `ORDER`
WHERE Date
BETWEEN DATE_ADD(CURRENT_DATE,INTERVAL -10 DAY) AND CURRENT_DATE;


SELECT Name, Stock, Price 
FROM ORDER_has_PRODUCT 
INNER JOIN PRODUCT ON PRODUCT_ID = PRODUCT.ID 
WHERE ORDER_ID = 1;


SELECT ORDER_ID, SUM(Price*QUANTITY) AS FINAL_PRICE
FROM ORDER_has_PRODUCT 
INNER JOIN PRODUCT ON PRODUCT_ID = PRODUCT.ID 
GROUP BY ORDER_ID;


SELECT SUM(Price*QUANTITY) AS FINAL_PRICE
FROM ORDER_has_PRODUCT
INNER JOIN PRODUCT ON PRODUCT_ID = PRODUCT.ID
INNER JOIN `ORDER` ON ORDER_ID = `ORDER`.ID
WHERE Date = CURRENT_DATE;


SELECT ORDER_ID, SUM(Price*QUANTITY) AS FINAL_PRICE 
FROM ORDER_has_PRODUCT
INNER JOIN PRODUCT ON PRODUCT_ID = PRODUCT.ID
GROUP BY ORDER_ID HAVING FINAL_PRICE  BETWEEN 100 and 550;


SELECT ID_CUSTOMERS, First_name, SUM(QUANTITY * Price) AS FINAL_PRICE
FROM ORDER_has_PRODUCT
INNER JOIN PRODUCT ON PRODUCT_ID = ID
INNER JOIN `ORDER` ON ORDER_ID = `ORDER`.ID
INNER JOIN CUSTOMERS ON ID_CUSTOMERS = CUSTOMERS.ID
GROUP BY ID_CUSTOMERS
HAVING First_name = 'Charlize';


SELECT First_name, Last_name, COUNT(ID_CUSTOMERS) AS NB_ORDERS
FROM `ORDER`
INNER JOIN CUSTOMERS ON ID_CUSTOMERS = CUSTOMERS.ID
GROUP BY First_name, Last_name, ID_CUSTOMERS;


SELECT First_name, Last_name, SUM(QUANTITY * Price) AS FINAL_PRICE
FROM `ORDER`
INNER JOIN CUSTOMERS ON ID_CUSTOMERS = CUSTOMERS.ID
INNER JOIN ORDER_has_PRODUCT ON ORDER_ID = `ORDER`.ID
INNER JOIN PRODUCT ON PRODUCT_ID = PRODUCT.ID
GROUP BY First_name, Last_name;
